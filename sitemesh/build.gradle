configurations {
    lexer
}

sourceSets.main.java.srcDirs += ['build/generated-sources/jflex']

ext.title = 'SiteMesh Library'
description = 'SiteMesh library'

dependencies {
    testImplementation 'junit:junit:4.5'
    testImplementation 'org.eclipse.jetty:jetty-servlet:9.4.51.v20230217'
    testImplementation 'org.eclipse.jetty:jetty-util:9.4.51.v20230217'
    testImplementation 'org.eclipse.jetty:jetty-http:9.4.51.v20230217:tests'
    testImplementation 'org.apache.ant:ant-testutil:1.10.14'

    compileOnly 'javax.servlet:javax.servlet-api:4.0.1'
    compileOnly 'org.apache.ant:ant:1.10.14'
    
    lexer 'de.jflex:jflex:1.4.3'
}


compileJava.doFirst {
    ant.taskdef classname: 'JFlex.anttask.JFlexTask', name: 'jflex', classpath: configurations.lexer.asPath
    ant.jflex(file: "src/main/java/org/sitemesh/tagprocessor/lexer.flex", destdir: "build/generated-sources/jflex")// "src/main/java/")
}

test {
     exclude '**/**$**'   
}